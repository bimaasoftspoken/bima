<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>valentine by bimaaa</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,sans-serif}
body{min-height:100vh;display:flex;justify-content:center;align-items:center;background:#fff1f2;color:#7a2848;overflow:hidden}

/* PHONE */
.phone{width:390px;max-width:95vw;background:#fff0f5;border-radius:40px;padding:20px;box-shadow:0 0 40px #f9a8d4;display:flex;flex-direction:column;gap:12px;position:relative;z-index:2}
.hidden{display:none}.center{text-align:center}
.grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:10px}
.menuGrid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
.btns{display:flex;gap:6px;margin-top:6px}
button{flex:1;padding:14px;border:none;border-radius:14px;background:#f9a8d4;color:#7a2848;font-size:15px;font-weight:bold;cursor:pointer}
input{width:100%;padding:14px;border-radius:15px;border:none;background:#ffe4e6;text-align:center;font-size:22px;letter-spacing:6px;margin-bottom:10px}
video{width:100%;border-radius:18px;margin-top:10px}
.gallery{display:flex;flex-wrap:wrap;gap:6px;margin-top:10px;justify-content:center}
.polaroid{background:white;padding:6px;border-radius:8px;cursor:pointer}
.polaroid img{width:75px;border-radius:6px}

/* PREVIEW */
.preview{position:fixed;inset:0;background:rgba(0,0,0,.9);display:flex;justify-content:center;align-items:center;z-index:20}
.preview img{max-width:90%}

/* HEART */
.hearts{position:fixed;inset:0;pointer-events:none;z-index:1}
.heart{position:absolute;color:#fb7185;animation:fall linear forwards}
@keyframes fall{to{transform:translateY(100vh);opacity:0}}

/* SAKURA */
.sakura{position:fixed;top:-20px;pointer-events:none;z-index:0;animation:sakuraFall linear forwards}
@keyframes sakuraFall{to{transform:translateY(110vh) rotate(360deg);opacity:0}}

/* LAMPU NEON */
.lampuNeon{
position:fixed;
top:0;
left:0;
width:100%;
display:flex;
justify-content:space-around;
z-index:0;
pointer-events:none;
}
.lampuNeon span{
font-size:20px;
animation:neon 1.5s infinite alternate;
}
@keyframes neon{
from{opacity:.4;transform:translateY(0)}
to{opacity:1;transform:translateY(6px)}
}

/* GIFT */
.letter,.gift{position:fixed;inset:0;background:rgba(0,0,0,.8);display:flex;justify-content:center;align-items:center;z-index:30;color:white;text-align:center;padding:20px}
.box{background:#fff0f5;color:#7a2848;padding:20px;border-radius:20px;max-width:320px}

.confetti{position:fixed;top:-30px;z-index:50;pointer-events:none}
@keyframes confettiFall{to{transform:translateY(110vh) rotate(720deg);opacity:0}}

.giftBox{width:170px;height:170px;background:#f472b6;border-radius:14px;position:relative;margin:auto;box-shadow:0 15px 25px rgba(0,0,0,.2)}
.giftBox::before{content:"";position:absolute;width:26px;height:100%;background:#fb7185;left:50%;transform:translateX(-50%)}
.giftLid{width:185px;height:45px;background:#fb7185;border-radius:12px;position:absolute;top:-40px;left:-7px;transform-origin:bottom center;transition:.6s}
.gift.open .giftLid{transform:rotate(-140deg) translateY(-30px)}

.ribbon{position:absolute;width:100%;height:26px;background:#fb7185;top:50%;transform:translateY(-50%);transition:.5s; z-index:1;}
.gift.open .ribbon{transform:translateY(-50%) translateX(220px);opacity:0}

.letterInside{position:absolute;bottom:20px;left:50%;transform:translateX(-50%) translateY(60px);background:white;padding:10px;border-radius:8px;font-size:14px;opacity:0;transition:.6s; z-index:3;}
.gift.open .letterInside{transform:translateX(-50%) translateY(-30px);opacity:1}

/* SURAT */
.surat{position:fixed;inset:0;background:#fff0f5;display:flex;justify-content:center;align-items:center;z-index:60;transform:scaleY(0);transform-origin:top;transition:.6s}
.surat.buka{transform:scaleY(1)}
.suratCard{background:white;padding:25px;border-radius:20px;max-width:320px;text-align:center;box-shadow:0 10px 25px rgba(0,0,0,.2)}



/* ===== STRING LIGHT WALL ===== */
.stringWall{
position:relative;
width:100%;
min-height:320px;
padding-top:80px;
}

/* kabel */
.stringLine{
position:absolute;
left:0;
width:100%;
height:2px;
background:#555;
}

/* posisi 3 kabel */
.stringLine:nth-child(1){top:40px;transform:rotate(-2deg);}
.stringLine:nth-child(2){top:130px;transform:rotate(1deg);}
.stringLine:nth-child(3){top:220px;transform:rotate(-1.5deg);}

.bulb{
position:absolute;
width:10px;
height:10px;
border-radius:50%;
background:#ffd166;
box-shadow:0 0 10px #ffd166,0 0 20px #ffd166;
opacity:.5;
transition:.4s;
animation:bulbSwing 3s ease-in-out infinite alternate;
}

@keyframes bulbSwing{
from{transform:rotate(-8deg)}
to{transform:rotate(8deg)}
}


/* foto gantung */
.hangingPhoto{
position:absolute;
background:white;
padding:6px;
border-radius:6px;
box-shadow:0 6px 14px rgba(0,0,0,.25);
animation:swing 3s ease-in-out infinite alternate;
cursor:pointer;
}

.hangingPhoto img{
width:70px;
border-radius:4px;
}

/* penjepit */
.hangingPhoto::before{
content:"";
position:absolute;
top:-14px;
left:50%;
transform:translateX(-50%);
}

/* goyang */
@keyframes swing{
from{transform:rotate(-3deg)}
to{transform:rotate(3deg)}
}

#galleryView{
position:relative;
width:100%;
min-height:320px;
}

.stringLine{ z-index:6; }
.bulb{ z-index:7; }
.hangingPhoto{ z-index:5; }


</style>
</head>

<body>

<div class="hearts" id="hearts"></div>

<div class="phone">

<div id="loginPage" class="center">
<input id="pass" readonly placeholder="PASSCODE">
<div class="grid">
<button onclick="add('1')">1</button><button onclick="add('2')">2</button><button onclick="add('3')">3</button>
<button onclick="add('4')">4</button><button onclick="add('5')">5</button><button onclick="add('6')">6</button>
<button onclick="add('7')">7</button><button onclick="add('8')">8</button><button onclick="add('9')">9</button>
<button onclick="add('*')">*</button><button onclick="add('0')">0</button><button onclick="clearPass()">âŒ«</button>
</div>
<button onclick="login()">Unlock</button>
</div>

<div id="homePage" class="hidden center">
<h2>Menu</h2><br>
<div class="menuGrid">
<button onclick="openCamera()">Kamera</button>
<button onclick="launchConfetti()">Confetti</button>
<button onclick="openGift()">Gift</button>
<button onclick="openGallery()">Galeri Foto</button>
</div>
</div>

<div id="cameraPage" class="hidden">
<h3>Kamera</h3>
<video id="video" autoplay playsinline></video>
<div id="countdown" 
style="position:absolute;
top:40%;
left:50%;
transform:translate(-50%,-50%);
font-size:60px;
font-weight:bold;
color:white;
text-shadow:0 0 20px black;
display:none;">
</div>
<div class="btns">
<button onclick="switchCamera()">Switch</button>
<button onclick="takePhoto(0)">Foto</button>
<button onclick="takePhoto(3)">Delay 3s</button>
<button onclick="takePhoto(5)">Delay 5s</button>
</div>
<br>
<button onclick="goHome()">Kembali</button>
<canvas id="canvas" class="hidden"></canvas>
<div id="gallery" class="gallery"></div>
</div>

<div id="galleryPage" class="hidden center">
<h3>Galeri Foto</h3>
<div id="galleryView" class="gallery"></div>
<br>
<button onclick="closeGallery()">Kembali</button>
</div>

</div>

<audio id="music" loop>
<source src="SnapTik.Net_7546283435434839301.mp3">
</audio>

<script>
  let photos=[];
let input="",currentFacing="environment",stream=null,heartInterval=null;

const pass=document.getElementById("pass");
const loginPage=document.getElementById("loginPage");
const homePage=document.getElementById("homePage");
const cameraPage=document.getElementById("cameraPage");
const galleryPage=document.getElementById("galleryPage");
const galleryView=document.getElementById("galleryView");
const video=document.getElementById("video");
const canvas=document.getElementById("canvas");
const gallery=document.getElementById("gallery");

function add(n){
if(input.length>=6)return;
input+=n;
pass.value="â—".repeat(input.length);
}

function clearPass(){
input=input.slice(0,-1);
pass.value="â—".repeat(input.length);
}

async function startCamera(){
try{

if(stream){
stream.getTracks().forEach(t=>t.stop());
}

stream=await navigator.mediaDevices.getUserMedia({
video:{
facingMode:currentFacing,
width:{ideal:1000},
height:{ideal:970}
}
});

video.srcObject=stream;

/* mirror hanya tampilan */
if(typeof currentFacing==="object"){
video.style.transform="scaleX(-1)";
}else{
video.style.transform="scaleX(1)";
}

}catch(e){
console.log(e);
alert("Kamera tidak tersedia / izin belum diberikan");
}
}


function switchCamera(){

if(currentFacing==="environment"){
currentFacing={exact:"user"};
}else{
currentFacing="environment";
}

startCamera();

}



function login(){
if(input==="1402"){
loginPage.classList.add("hidden");
homePage.classList.remove("hidden");
startValentine();
}else alert("Pass salah");
input="";
pass.value="";
}

function openCamera(){
homePage.classList.add("hidden");
cameraPage.classList.remove("hidden");
startCamera();
}

function goHome(){
cameraPage.classList.add("hidden");
galleryPage.classList.add("hidden");
homePage.classList.remove("hidden");
if(stream)stream.getTracks().forEach(t=>t.stop());
}



async function takePhoto(delay=0){

const countdown=document.getElementById("countdown");

if(delay>0){

countdown.style.display="block";

for(let i=delay;i>0;i--){
countdown.innerText=i;
await new Promise(r=>setTimeout(r,1000));
}

countdown.style.display="none";
}

canvas.width=video.videoWidth;
canvas.height=video.videoHeight;

let ctx=canvas.getContext("2d");

ctx.imageSmoothingEnabled=true;
ctx.imageSmoothingQuality="high";

/* fix mirror kamera depan */
if(typeof currentFacing==="object"){
ctx.translate(canvas.width,0);
ctx.scale(-1,1);
}

ctx.drawImage(video,0,0,canvas.width,canvas.height);

let src=canvas.toDataURL("image/png",1.0);

photos.push(src);

showToast(" Foto berhasil diambil cek pada menu galeri");

renderGallery();
}





function showPreview(html){
let p=document.createElement("div");
p.className="preview";
p.innerHTML=html;
p.onclick=()=>p.remove();
document.body.appendChild(p);
}

function openGallery(){
homePage.classList.add("hidden");
galleryPage.classList.remove("hidden");
renderGallery();
}


function closeGallery(){goHome();}

function startValentine(){
playMusic();
startHearts();
startSakura();
}

function playMusic(){
document.getElementById("music").play().catch(()=>{});
}

function startHearts(){
if(heartInterval)return;
heartInterval=setInterval(()=>{
let h=document.createElement("div");
h.className="heart";
h.innerText="ðŸ’—";
h.style.left=Math.random()*100+"%";
h.style.top="-20px";
h.style.fontSize=20+Math.random()*20+"px";
h.style.animationDuration=4+Math.random()*4+"s";
document.getElementById("hearts").appendChild(h);
setTimeout(()=>h.remove(),8000);
},400);
}

function startSakura(){
setInterval(()=>{
let s=document.createElement("div");
s.className="sakura";
s.innerText="ðŸ©·";
s.style.left=Math.random()*100+"%";
s.style.fontSize=18+Math.random()*16+"px";
s.style.animationDuration=5+Math.random()*4+"s";
document.body.appendChild(s);
setTimeout(()=>s.remove(),9000);
},600);
}

function launchConfetti(){
const shapes=["ðŸ’—","ðŸ’•","ðŸŒ¸","ðŸ’ž","ðŸ©·"];
for(let i=0;i<40;i++){
let c=document.createElement("div");
c.className="confetti";
c.innerText=shapes[Math.floor(Math.random()*shapes.length)];
c.style.left=Math.random()*120+"vw";
c.style.animation="confettiFall 3s linear forwards";
document.body.appendChild(c);
setTimeout(()=>c.remove(),3000);
}
}

function giftConfetti(x,y){
const shapes=["ðŸ’—","ðŸ’•","ðŸ’–","ðŸŒ¸","ðŸŽ€","ðŸ’ž","ðŸ©·"];
for(let i=0;i<40;i++){
let c=document.createElement("div");
c.className="confetti";
c.innerText=shapes[Math.floor(Math.random()*shapes.length)];
c.style.left=x+"px";
c.style.top=y+"px";
c.style.position="fixed";
let angle=Math.random()*Math.PI*2;
let distance=130+Math.random()*140;
c.animate([{transform:"translate(0,0)",opacity:1},{transform:`translate(${Math.cos(angle)*distance}px,${Math.sin(angle)*distance}px) rotate(720deg)`,opacity:0}],{duration:1000,easing:"ease-out"});
document.body.appendChild(c);
setTimeout(()=>c.remove(),1300);
}
}

function openGift(){
let g=document.createElement("div");
g.className="gift";

g.innerHTML=`
<div class="box">
<div class="giftBox" id="giftBox">
<div class="giftLid"></div>
<div class="ribbon" id="ribbon"></div>
<div class="letterInside" onclick="showLetter()"> Klik untuk buka surat</div>
</div>
<br>
<button onclick="openGiftAnim()">Buka Hadiah</button>
<button onclick="this.closest('.gift').remove()">Tutup Gift</button>
</div>`;

document.body.appendChild(g);
}

function openGiftAnim(){
let gift=document.querySelector(".gift");
let box=document.getElementById("giftBox");
let rect=box.getBoundingClientRect();
let x=rect.left+rect.width/2;
let y=rect.top+20;
document.getElementById("ribbon").style.transform="translateY(-50%) translateX(220px)";
document.getElementById("ribbon").style.opacity="0";
setTimeout(()=>{gift.classList.add("open");},400);
setTimeout(()=>giftConfetti(x,y),650);
setTimeout(()=>giftConfetti(x,y),850);
}

function showLetter(){
if(document.querySelector(".surat"))return;
let s=document.createElement("div");
s.className="surat";
s.innerHTML=`<div class="suratCard"
<br>
<h2> Happy Valentine</h2>
<br>
<button onclick="this.closest('.surat').remove()">Tutup</button>
</div>`;
document.body.appendChild(s);
setTimeout(()=>s.classList.add("buka"),100);
}


function enableStickerDrag(container){
let sticker=container.querySelector(".sticker");
let offsetX,offsetY,isDown=false;

sticker.onmousedown=(e)=>{
isDown=true;
offsetX=e.offsetX;
offsetY=e.offsetY;
};

document.onmouseup=()=>{isDown=false};

document.onmousemove=(e)=>{
if(!isDown)return;
let rect=container.getBoundingClientRect();
sticker.style.left=(e.clientX-rect.left-offsetX)+"px";
sticker.style.top=(e.clientY-rect.top-offsetY)+"px";
};
}

function buildStringWall(){

let wall=document.getElementById("galleryView");
wall.innerHTML="";

for(let i=0;i<3;i++){

let line=document.createElement("div");
line.className="stringLine";
wall.appendChild(line);

/* lampu LED */
for(let l=0;l<6;l++){
let bulb=document.createElement("div");
bulb.className="bulb";
bulb.style.left=(10+l*15)+"%";
bulb.style.top="-4px";
line.appendChild(bulb);
}

}
}

function renderGallery(){

let wall=document.getElementById("galleryView");
wall.innerHTML="";

buildStringWall();

photos.forEach((src,i)=>{

let photo=document.createElement("div");
photo.className="hangingPhoto";

let img=document.createElement("img");
img.src=src;

photo.appendChild(img);

photo.style.left=(5+(i%4)*22)+"%";
photo.style.top=(40+Math.floor(i/4)*90)+"px";

photo.onclick=()=>showPreview(`<img src="${src}">`);

wall.appendChild(photo);

});

startGodLights();

}

let lampuInterval=null;

function startGodLights(){

if(lampuInterval!==null)return;

const colors=[
"#ffd166",
"#fb7185",
"#f472b6",
"#a78bfa",
"#60a5fa",
"#f9a8d4"
];

lampuInterval=setInterval(()=>{

document.querySelectorAll(".bulb").forEach(b=>{

let delay=Math.random()*800;

setTimeout(()=>{

let color=colors[Math.floor(Math.random()*colors.length)];

b.style.background=color;
b.style.boxShadow=`0 0 10px ${color},0 0 25px ${color},0 0 40px ${color}`;

b.style.opacity=Math.random()>.3?1:.25;

let scale=1+Math.random()*0.5;
b.style.transform=`scale(${scale}) rotate(${Math.random()*16-8}deg)`;

},delay);

});

},600);

}

function showToast(text){

let t=document.createElement("div");

t.innerText=text;

t.style.position="fixed";
t.style.bottom="40px";
t.style.left="50%";
t.style.transform="translateX(-50%)";
t.style.background="#f472b6";
t.style.color="white";
t.style.padding="12px 20px";
t.style.borderRadius="20px";
t.style.fontWeight="bold";
t.style.boxShadow="0 5px 15px rgba(0,0,0,.2)";
t.style.zIndex="999";

document.body.appendChild(t);

setTimeout(()=>{
t.style.opacity="0";
setTimeout(()=>t.remove(),400);
},2000);
}


</script>


</body>
</html>
